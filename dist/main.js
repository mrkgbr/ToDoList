(()=>{"use strict";const t=document.querySelector("body");function e(){return JSON.parse(localStorage.getItem("toDos"))||[]}function n(t){if(document.querySelector(".todo").textContent="",t)return void t.forEach(((t,e)=>{new s(t.id,e,t.task,t.description,t.date,t.completed,t.project,t.priority)}));const n=e();n.forEach(((t,e)=>{new s(e,e,t.task,t.description,t.date,t.completed,t.project,t.priority),n[e].id=e,localStorage.setItem("toDos",JSON.stringify(n))}))}class s{constructor(t,e,n,s,a,o,c,i){this.id=t,this.listId=e,this.title=n,this.description=s,this.date=a,this.completed=o,this.project=c,this.priority=i,this.#t()}createTaskContainer(t){const e=document.createElement("div");switch(e.classList.add("task-container"),e.setAttribute("id",this.id),t.appendChild(e),this.priority){case"1":e.classList.add("prio1");break;case"2":e.classList.add("prio2");break;case"3":e.classList.add("prio3");break;default:console.log("black")}return e}#t(){const t=document.querySelector(".todo"),s=this.createTaskContainer(t),a=document.createElement("form");a.classList.add("task-form"),s.appendChild(a);const o=document.createElement("input");o.setAttribute("type","text"),o.setAttribute("name","taskTitle"),o.value=this.title,o.classList.add("task-title"),o.readOnly=!0,a.appendChild(o);const c=document.createElement("textarea");c.setAttribute("name","taskDescription"),c.setAttribute("rows",1),c.value=this.description,c.classList.add("task-description"),c.readOnly=!0,a.appendChild(c);const i=document.createElement("input");i.setAttribute("type","date"),i.setAttribute("name","taskDate"),i.value=this.date,i.classList.add("task-date"),i.readOnly=!0,a.appendChild(i);const r=document.createElement("select");r.classList.add("task-selector"),r.disabled=!0,a.appendChild(r),document.querySelectorAll("#project-select option").forEach((t=>{const e=document.createElement("option");e.value=t.value,e.textContent=t.label,this.project===t.value&&e.setAttribute("selected","selected"),r.appendChild(e)}));const d=document.createElement("input");d.setAttribute("type","submit"),d.value="EDIT",d.classList.add("edit-button"),d.classList.add("task-button"),a.appendChild(d),d.addEventListener("click",(t=>{var s;t.preventDefault(),s=this.listId,document.querySelectorAll(".task-form").forEach(((t,e)=>{s!==e&&(t.querySelector(".edit-button").disabled=!0,t.querySelector(".delete-button").disabled=!0)})),d.value="SAVE",o.readOnly=!1,o.classList.toggle("edit"),c.readOnly=!1,c.classList.toggle("edit"),i.readOnly=!1,i.classList.toggle("edit"),r.disabled=!1,d.addEventListener("click",(t=>{t.preventDefault(),d.value="EDIT",o.readOnly=!0,o.classList.toggle("edit"),c.readOnly=!0,c.classList.toggle("edit"),i.readOnly=!0,r.disabled=!0,i.classList.toggle("edit");const s=e();s[this.id].task=a.taskTitle.value,s[this.id].description=a.taskDescription.value,s[this.id].date=a.taskDate.value,s[this.id].project=r.value,localStorage.setItem("toDos",JSON.stringify(s)),n()}))}));const l=document.createElement("button");l.textContent="DONE",l.classList.add("delete-button"),l.classList.add("task-button"),a.appendChild(l),l.addEventListener("click",(t=>{t.preventDefault();const n=e();n.splice(this.id,1),document.querySelectorAll(".task-container")[this.listId].remove(),localStorage.setItem("toDos",JSON.stringify(n))}))}}class a{static projects=[{name:"Inbox",protected:!0},{name:"Today",protected:!0}];static renderProjects(){this.parseProjects().forEach((t=>{this.createProject(t)}))}static parseProjects(){let t=JSON.parse(localStorage.getItem("projectList"))||[];return 0===t.length&&(t=this.projects,localStorage.setItem("projectList",JSON.stringify(t))),t}static addProjects(t){const e=JSON.parse(localStorage.getItem("projectList"));e.push(t),localStorage.setItem("projectList",JSON.stringify(e))}static removeProjects(t){const e=JSON.parse(localStorage.getItem("projectList"));e.splice(t,1),localStorage.setItem("projectList",JSON.stringify(e)),document.querySelectorAll(".project")[t].remove(),document.querySelectorAll("#project-select option")[t-1].remove(),n()}static createProject(t){const s=document.querySelector(".project-container"),a=document.createElement("div");a.classList.add("project"),a.setAttribute("id",t.name),s.appendChild(a);const o=document.createElement("p");if(o.textContent=t.name,a.appendChild(o),!t.protected){const e=document.createElement("button");e.textContent="DEL",a.appendChild(e),e.addEventListener("click",(()=>{const e=this.parseProjects().findIndex((e=>e.name===t.name));this.removeProjects(e)}))}if("Inbox"!==t.name&&"Today"!==t.name&&"Late"!==t.name){const e=document.querySelector("#project-select"),n=document.createElement("option");n.value=t.name.toLowerCase(),n.textContent=t.name,e.appendChild(n)}o.addEventListener("click",(()=>{const s=e();"Inbox"!==t.name?"Today"!==t.name?n(s.filter((e=>e.project===t.name.toLowerCase()))):n(s.filter((t=>{const e=(new Date).toJSON(),n=Date.parse(e);return Date.parse(t.date)<n}))):n()}))}static newProject(t){this.createProject(t),this.addProjects(t),n()}}!function(){const e=document.createElement("div");e.classList.add("sidebar"),t.appendChild(e);const n=document.createElement("button");n.classList.add("new-button"),n.textContent="Create Task",e.appendChild(n);const s=document.createElement("button");s.classList.add("project-button"),s.textContent="Add Project",e.appendChild(s);const a=document.createElement("div");a.classList.add("project-container"),e.appendChild(a)}(),function(){const e=document.createElement("div");e.classList.add("todo"),t.appendChild(e)}(),function(){const e=document.createElement("div");e.classList.add("form-container"),e.classList.add("hidden"),t.appendChild(e);const n=document.createElement("div");n.classList.add("form-main"),e.appendChild(n);const s=document.createElement("form");s.classList.add("form"),n.appendChild(s);const a=document.createElement("label");a.setAttribute("for","task"),a.textContent="Task Title",s.appendChild(a);const o=document.createElement("input");o.setAttribute("type","text"),o.setAttribute("id","task"),o.setAttribute("name","task"),o.setAttribute("placeholder","e.g. walk the dog"),o.setAttribute("required",""),s.appendChild(o);const c=document.createElement("label");c.setAttribute("for","description"),c.textContent="Description",s.appendChild(c);const i=document.createElement("textarea");i.setAttribute("id","description"),i.setAttribute("name","description"),i.setAttribute("rows","6"),i.setAttribute("maxlength","200"),s.appendChild(i);const r=document.createElement("label");r.setAttribute("for","datum"),r.textContent="Due date",s.appendChild(r);const d=document.createElement("input");d.setAttribute("type","date"),d.setAttribute("id","datum"),d.setAttribute("name","datum"),s.appendChild(d);const l=document.createElement("select");l.setAttribute("id","project-select"),l.setAttribute("name","projectselect"),s.appendChild(l);const u=document.createElement("option");u.value="default",u.textContent="-",l.appendChild(u);const p=document.createElement("select");p.setAttribute("id","priority-select"),p.setAttribute("name","priorityselect"),s.appendChild(p);const m=document.createElement("option");m.value="1",m.textContent="1",p.appendChild(m);const h=document.createElement("option");h.value="2",h.textContent="2",p.appendChild(h);const b=document.createElement("option");b.value="3",b.textContent="3",p.appendChild(b);const v=document.createElement("input");v.setAttribute("type","submit"),v.setAttribute("id","submit"),v.setAttribute("value","Add"),s.appendChild(v);const C=document.createElement("button");C.setAttribute("id","cancel"),C.textContent="Cancel",s.appendChild(C)}(),document.querySelector("#cancel").addEventListener("click",(t=>{t.preventDefault(),document.querySelector(".form-container").classList.toggle("hidden");const e=document.querySelector(".form");e.task.value="",e.description.value="",e.datum.value=""})),document.querySelector("#submit").addEventListener("click",(t=>{t.preventDefault();const s=document.querySelector(".form");s.task.value&&s.datum.value?(document.querySelector(".form-container").classList.toggle("hidden"),function(t){const s=e(),a={task:t.task.value,description:t.description.value,date:t.datum.value,completed:!1,project:t.projectselect.value,priority:t.priorityselect.value};s.push(a),localStorage.setItem("toDos",JSON.stringify(s)),n()}(s),s.reset(),n()):alert("Please add Title and Due date!")})),document.querySelector(".new-button").addEventListener("click",(()=>{document.querySelector(".form-container").classList.toggle("hidden")})),document.querySelector(".project-button").addEventListener("click",(()=>{const t=prompt("Please enter a project name:","New Project");if(!t)return;const e={name:t,protected:!1};a.newProject(e)})),a.renderProjects(),n()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoibUJBQUEsTUFBTUEsRUFBT0MsU0FBU0MsY0FBYyxRQ0NwQyxTQUFTQyxJQUNQLE9BQU9DLEtBQUtDLE1BQU1DLGFBQWFDLFFBQVEsV0FBYSxFQUN0RCxDQUVBLFNBQVNDLEVBQU9DLEdBSWQsR0FIY1IsU0FBU0MsY0FBYyxTQUMvQlEsWUFBYyxHQUVoQkQsRUFlRixZQWRjQSxFQUNSRSxTQUFRLENBQUNDLEVBQU1DLEtBRWpCLElBQUlDLEVBQ0ZGLEVBQUtDLEdBQ0xBLEVBQ0FELEVBQUtHLEtBQ0xILEVBQUtJLFlBQ0xKLEVBQUtLLEtBQ0xMLEVBQUtNLFVBQ0xOLEVBQUtPLFFBQ0xQLEVBQUtRLFNBQ0gsSUFLVixNQUFNQyxFQUFRbEIsSUFDZGtCLEVBQU1WLFNBQVEsQ0FBQ0MsRUFBTUMsS0FFakIsSUFBSUMsRUFDRkQsRUFDQUEsRUFDQUQsRUFBS0csS0FDTEgsRUFBS0ksWUFDTEosRUFBS0ssS0FDTEwsRUFBS00sVUFDTE4sRUFBS08sUUFDTFAsRUFBS1EsVUFFVEMsRUFBTVIsR0FBSUEsR0FBS0EsRUFDZlAsYUFBYWdCLFFBQVEsUUFBU2xCLEtBQUttQixVQUFVRixHQUFPLEdBRXhELENBRUEsTUFBTVAsRUFDSlUsWUFDRVgsRUFDQVksRUFDQUMsRUFDQVYsRUFDQUMsRUFDQUMsRUFDQUMsRUFDQUMsR0FFQU8sS0FBS2QsR0FBS0EsRUFDVmMsS0FBS0YsT0FBU0EsRUFDZEUsS0FBS0QsTUFBUUEsRUFDYkMsS0FBS1gsWUFBY0EsRUFDbkJXLEtBQUtWLEtBQU9BLEVBQ1pVLEtBQUtULFVBQVlBLEVBQ2pCUyxLQUFLUixRQUFVQSxFQUNmUSxLQUFLUCxTQUFXQSxFQUNoQk8sTUFBSyxHQUNQLENBRUFDLG9CQUFvQkMsR0FFbEIsTUFBTWQsRUFBT2QsU0FBUzZCLGNBQWMsT0FJcEMsT0FIQWYsRUFBS2dCLFVBQVVDLElBQUksa0JBQ25CakIsRUFBS2tCLGFBQWEsS0FBTU4sS0FBS2QsSUFDN0JnQixFQUFNSyxZQUFZbkIsR0FDVlksS0FBS1AsVUFDWCxJQUFLLElBQ0hMLEVBQUtnQixVQUFVQyxJQUFJLFNBQ25CLE1BQ0YsSUFBSyxJQUNIakIsRUFBS2dCLFVBQVVDLElBQUksU0FDbkIsTUFDRixJQUFLLElBQ0hqQixFQUFLZ0IsVUFBVUMsSUFBSSxTQUNuQixNQUNGLFFBQ0VHLFFBQVFDLElBQUksU0FHaEIsT0FBT3JCLENBQ1QsQ0FHQSxLQUNFLE1BQU1jLEVBQVE1QixTQUFTQyxjQUFjLFNBRS9CYSxFQUFPWSxLQUFLQyxvQkFBb0JDLEdBR2hDUSxFQUFXcEMsU0FBUzZCLGNBQWMsUUFDeENPLEVBQVNOLFVBQVVDLElBQUksYUFDdkJqQixFQUFLbUIsWUFBWUcsR0FHakIsTUFBTVgsRUFBUXpCLFNBQVM2QixjQUFjLFNBQ3JDSixFQUFNTyxhQUFhLE9BQVEsUUFDM0JQLEVBQU1PLGFBQWEsT0FBUSxhQUMzQlAsRUFBTVksTUFBUVgsS0FBS0QsTUFDbkJBLEVBQU1LLFVBQVVDLElBQUksY0FDcEJOLEVBQU1hLFVBQVcsRUFDakJGLEVBQVNILFlBQVlSLEdBR3JCLE1BQU1WLEVBQWNmLFNBQVM2QixjQUFjLFlBQzNDZCxFQUFZaUIsYUFBYSxPQUFRLG1CQUNqQ2pCLEVBQVlpQixhQUFhLE9BQVEsR0FDakNqQixFQUFZc0IsTUFBUVgsS0FBS1gsWUFDekJBLEVBQVllLFVBQVVDLElBQUksb0JBQzFCaEIsRUFBWXVCLFVBQVcsRUFDdkJGLEVBQVNILFlBQVlsQixHQUdyQixNQUFNQyxFQUFPaEIsU0FBUzZCLGNBQWMsU0FDcENiLEVBQUtnQixhQUFhLE9BQVEsUUFDMUJoQixFQUFLZ0IsYUFBYSxPQUFRLFlBQzFCaEIsRUFBS3FCLE1BQVFYLEtBQUtWLEtBQ2xCQSxFQUFLYyxVQUFVQyxJQUFJLGFBQ25CZixFQUFLc0IsVUFBVyxFQUNoQkYsRUFBU0gsWUFBWWpCLEdBR3JCLE1BQU11QixFQUFnQnZDLFNBQVM2QixjQUFjLFVBQzdDVSxFQUFjVCxVQUFVQyxJQUFJLGlCQUM1QlEsRUFBY0MsVUFBVyxFQUN6QkosRUFBU0gsWUFBWU0sR0FDRnZDLFNBQVN5QyxpQkFBaUIsMEJBQ2xDL0IsU0FBU2dDLElBQ2xCLE1BQU1DLEVBQVkzQyxTQUFTNkIsY0FBYyxVQUN6Q2MsRUFBVU4sTUFBUUssRUFBSUwsTUFDdEJNLEVBQVVsQyxZQUFjaUMsRUFBSUUsTUFDeEJsQixLQUFLUixVQUFZd0IsRUFBSUwsT0FDdkJNLEVBQVVYLGFBQWEsV0FBWSxZQUVyQ08sRUFBY04sWUFBWVUsRUFBVSxJQWdCdEMsTUFBTUUsRUFBVTdDLFNBQVM2QixjQUFjLFNBQ3ZDZ0IsRUFBUWIsYUFBYSxPQUFRLFVBQzdCYSxFQUFRUixNQUFRLE9BQ2hCUSxFQUFRZixVQUFVQyxJQUFJLGVBQ3RCYyxFQUFRZixVQUFVQyxJQUFJLGVBQ3RCSyxFQUFTSCxZQUFZWSxHQUVyQkEsRUFBUUMsaUJBQWlCLFNBQVVDLElBcEJuQyxJQUF3QkMsRUFxQnRCRCxFQUFFRSxpQkFyQm9CRCxFQXNCUHRCLEtBQUtGLE9BckJEeEIsU0FBU3lDLGlCQUFpQixjQUNsQy9CLFNBQVEsQ0FBQ0MsRUFBTUMsS0FDcEJvQyxJQUFXcEMsSUFDTUQsRUFBS1YsY0FBYyxnQkFDM0J1QyxVQUFXLEVBQ0Q3QixFQUFLVixjQUFjLGtCQUMzQnVDLFVBQVcsRUFDMUIsSUFlRkssRUFBUVIsTUFBUSxPQUNoQlosRUFBTWEsVUFBVyxFQUNqQmIsRUFBTUssVUFBVW9CLE9BQU8sUUFDdkJuQyxFQUFZdUIsVUFBVyxFQUN2QnZCLEVBQVllLFVBQVVvQixPQUFPLFFBQzdCbEMsRUFBS3NCLFVBQVcsRUFDaEJ0QixFQUFLYyxVQUFVb0IsT0FBTyxRQUN0QlgsRUFBY0MsVUFBVyxFQUV6QkssRUFBUUMsaUJBQWlCLFNBQVVLLElBQ2pDQSxFQUFNRixpQkFDTkosRUFBUVIsTUFBUSxPQUNoQlosRUFBTWEsVUFBVyxFQUNqQmIsRUFBTUssVUFBVW9CLE9BQU8sUUFDdkJuQyxFQUFZdUIsVUFBVyxFQUN2QnZCLEVBQVllLFVBQVVvQixPQUFPLFFBQzdCbEMsRUFBS3NCLFVBQVcsRUFDaEJDLEVBQWNDLFVBQVcsRUFFekJ4QixFQUFLYyxVQUFVb0IsT0FBTyxRQUN0QixNQUFNRSxFQUFPbEQsSUFDYmtELEVBQUsxQixLQUFLZCxJQUFJRSxLQUFPc0IsRUFBU2lCLFVBQVVoQixNQUN4Q2UsRUFBSzFCLEtBQUtkLElBQUlHLFlBQWNxQixFQUFTa0IsZ0JBQWdCakIsTUFDckRlLEVBQUsxQixLQUFLZCxJQUFJSSxLQUFPb0IsRUFBU21CLFNBQVNsQixNQUN2Q2UsRUFBSzFCLEtBQUtkLElBQUlNLFFBQVVxQixFQUFjRixNQUN0Q2hDLGFBQWFnQixRQUFRLFFBQVNsQixLQUFLbUIsVUFBVThCLElBQzdDN0MsR0FBUSxHQUNSLElBSUosTUFBTWlELEVBQVl4RCxTQUFTNkIsY0FBYyxVQUN6QzJCLEVBQVUvQyxZQUFjLE9BQ3hCK0MsRUFBVTFCLFVBQVVDLElBQUksaUJBQ3hCeUIsRUFBVTFCLFVBQVVDLElBQUksZUFDeEJLLEVBQVNILFlBQVl1QixHQUVyQkEsRUFBVVYsaUJBQWlCLFNBQVVXLElBQ25DQSxFQUFJUixpQkFDSixNQUFNRyxFQUFPbEQsSUFDYmtELEVBQUtNLE9BQU9oQyxLQUFLZCxHQUFJLEdBQ3JCWixTQUFTeUMsaUJBQWlCLG1CQUFtQmYsS0FBS0YsUUFBUW1DLFNBQzFEdEQsYUFBYWdCLFFBQVEsUUFBU2xCLEtBQUttQixVQUFVOEIsR0FBTSxHQUd2RCxFQ2xOYSxNQUFNUSxFQUNuQkMsZ0JBQWtCLENBQ2hCLENBQ0VDLEtBQU0sUUFDTkMsV0FBVyxHQUViLENBQ0VELEtBQU0sUUFDTkMsV0FBVyxJQUlmRix3QkFDZ0JuQyxLQUFLc0MsZ0JBQ2J0RCxTQUFTQyxJQUNiZSxLQUFLdUMsY0FBY3RELEVBQUssR0FHNUIsQ0FFQWtELHVCQUNFLElBQUlLLEVBQVEvRCxLQUFLQyxNQUFNQyxhQUFhQyxRQUFRLGlCQUFtQixHQUsvRCxPQUpxQixJQUFqQjRELEVBQU1DLFNBQ1JELEVBQVF4QyxLQUFLMEMsU0FDYi9ELGFBQWFnQixRQUFRLGNBQWVsQixLQUFLbUIsVUFBVTRDLEtBRTlDQSxDQUNULENBRUFMLG1CQUFtQmxELEdBQ2pCLE1BQU11RCxFQUFRL0QsS0FBS0MsTUFBTUMsYUFBYUMsUUFBUSxnQkFDOUM0RCxFQUFNRyxLQUFLMUQsR0FDWE4sYUFBYWdCLFFBQVEsY0FBZWxCLEtBQUttQixVQUFVNEMsR0FDckQsQ0FFQUwsc0JBQXNCUyxHQUNwQixNQUFNSixFQUFRL0QsS0FBS0MsTUFBTUMsYUFBYUMsUUFBUSxnQkFDOUM0RCxFQUFNUixPQUFPWSxFQUFPLEdBQ3BCakUsYUFBYWdCLFFBQVEsY0FBZWxCLEtBQUttQixVQUFVNEMsSUFDbkRsRSxTQUFTeUMsaUJBQWlCLFlBQVk2QixHQUFPWCxTQUM3QzNELFNBQVN5QyxpQkFBaUIsMEJBQTBCNkIsRUFBUSxHQUFHWCxTQUMvRHBELEdBQ0YsQ0FFQXNELHFCQUFxQmxELEdBQ25CLE1BQU00RCxFQUFtQnZFLFNBQVNDLGNBQWMsc0JBQzFDdUUsRUFBY3hFLFNBQVM2QixjQUFjLE9BQzNDMkMsRUFBWTFDLFVBQVVDLElBQUksV0FDMUJ5QyxFQUFZeEMsYUFBYSxLQUFNckIsRUFBS21ELE1BQ3BDUyxFQUFpQnRDLFlBQVl1QyxHQUM3QixNQUFNdEQsRUFBVWxCLFNBQVM2QixjQUFjLEtBSXZDLEdBSEFYLEVBQVFULFlBQWNFLEVBQUttRCxLQUMzQlUsRUFBWXZDLFlBQVlmLElBRW5CUCxFQUFLb0QsVUFBVyxDQUNuQixNQUFNVSxFQUFnQnpFLFNBQVM2QixjQUFjLFVBQzdDNEMsRUFBY2hFLFlBQWMsTUFDNUIrRCxFQUFZdkMsWUFBWXdDLEdBQ3hCQSxFQUFjM0IsaUJBQWlCLFNBQVMsS0FDdEMsTUFDTXdCLEVBRFc1QyxLQUFLc0MsZ0JBQ0NVLFdBQ3BCQyxHQUFjQSxFQUFVYixPQUFTbkQsRUFBS21ELE9BRXpDcEMsS0FBS2tELGVBQWVOLEVBQU0sR0FFOUIsQ0FFQSxHQUNnQixVQUFkM0QsRUFBS21ELE1BQ1MsVUFBZG5ELEVBQUttRCxNQUNTLFNBQWRuRCxFQUFLbUQsS0FDTCxDQUNBLE1BQU1lLEVBQVM3RSxTQUFTQyxjQUFjLG1CQUNoQzBDLEVBQVkzQyxTQUFTNkIsY0FBYyxVQUN6Q2MsRUFBVU4sTUFBUTFCLEVBQUttRCxLQUFLZ0IsY0FDNUJuQyxFQUFVbEMsWUFBY0UsRUFBS21ELEtBQzdCZSxFQUFPNUMsWUFBWVUsRUFDckIsQ0FFQXpCLEVBQVE0QixpQkFBaUIsU0FBUyxLQUNoQyxNQUFNaUMsRUFBWTdFLElBQ0EsVUFBZFMsRUFBS21ELEtBS1MsVUFBZG5ELEVBQUttRCxLQWNUdkQsRUFIcUJ3RSxFQUFVQyxRQUM1QkMsR0FBY0EsRUFBVS9ELFVBQVlQLEVBQUttRCxLQUFLZ0IsaUJBTC9DdkUsRUFOcUJ3RSxFQUFVQyxRQUFRQyxJQUNyQyxNQUFNakUsR0FBTyxJQUFJa0UsTUFBT0MsU0FDbEJDLEVBQWNGLEtBQUs5RSxNQUFNWSxHQUUvQixPQURzQmtFLEtBQUs5RSxNQUFNNkUsRUFBVWpFLE1BQ3BCb0UsQ0FBVyxLQVRwQzdFLEdBa0JrQixHQUV4QixDQUVBc0Qsa0JBQWtCbEQsR0FDaEJlLEtBQUt1QyxjQUFjdEQsR0FDbkJlLEtBQUsyRCxZQUFZMUUsR0FDakJKLEdBQ0YsR0Z0R0YsV0FDRSxNQUFNK0UsRUFBTXRGLFNBQVM2QixjQUFjLE9BQ25DeUQsRUFBSXhELFVBQVVDLElBQUksV0FDbEJoQyxFQUFLa0MsWUFBWXFELEdBRWpCLE1BQU1DLEVBQVl2RixTQUFTNkIsY0FBYyxVQUN6QzBELEVBQVV6RCxVQUFVQyxJQUFJLGNBQ3hCd0QsRUFBVTlFLFlBQWMsY0FDeEI2RSxFQUFJckQsWUFBWXNELEdBRWhCLE1BQU1DLEVBQW1CeEYsU0FBUzZCLGNBQWMsVUFDaEQyRCxFQUFpQjFELFVBQVVDLElBQUksa0JBQy9CeUQsRUFBaUIvRSxZQUFjLGNBQy9CNkUsRUFBSXJELFlBQVl1RCxHQUVoQixNQUFNakIsRUFBbUJ2RSxTQUFTNkIsY0FBYyxPQUNoRDBDLEVBQWlCekMsVUFBVUMsSUFBSSxxQkFDL0J1RCxFQUFJckQsWUFBWXNDLEVBQ2xCLENBZ0dFa0IsR0F4SEYsV0FDRSxNQUFNSCxFQUFNdEYsU0FBUzZCLGNBQWMsT0FDbkN5RCxFQUFJeEQsVUFBVUMsSUFBSSxRQUNsQmhDLEVBQUtrQyxZQUFZcUQsRUFDbkIsQ0FzSEVJLEdBaEdGLFdBRUUsTUFBTUMsRUFBWTNGLFNBQVM2QixjQUFjLE9BQ3pDOEQsRUFBVTdELFVBQVVDLElBQUksa0JBQ3hCNEQsRUFBVTdELFVBQVVDLElBQUksVUFDeEJoQyxFQUFLa0MsWUFBWTBELEdBRWpCLE1BQU1DLEVBQU81RixTQUFTNkIsY0FBYyxPQUNwQytELEVBQUs5RCxVQUFVQyxJQUFJLGFBQ25CNEQsRUFBVTFELFlBQVkyRCxHQUd0QixNQUFNQyxFQUFPN0YsU0FBUzZCLGNBQWMsUUFDcENnRSxFQUFLL0QsVUFBVUMsSUFBSSxRQUNuQjZELEVBQUszRCxZQUFZNEQsR0FHakIsTUFBTUMsRUFBWTlGLFNBQVM2QixjQUFjLFNBQ3pDaUUsRUFBVTlELGFBQWEsTUFBTyxRQUM5QjhELEVBQVVyRixZQUFjLGFBQ3hCb0YsRUFBSzVELFlBQVk2RCxHQUNqQixNQUFNaEYsRUFBT2QsU0FBUzZCLGNBQWMsU0FDcENmLEVBQUtrQixhQUFhLE9BQVEsUUFDMUJsQixFQUFLa0IsYUFBYSxLQUFNLFFBQ3hCbEIsRUFBS2tCLGFBQWEsT0FBUSxRQUMxQmxCLEVBQUtrQixhQUFhLGNBQWUscUJBQ2pDbEIsRUFBS2tCLGFBQWEsV0FBWSxJQUM5QjZELEVBQUs1RCxZQUFZbkIsR0FHakIsTUFBTWlGLEVBQW1CL0YsU0FBUzZCLGNBQWMsU0FDaERrRSxFQUFpQi9ELGFBQWEsTUFBTyxlQUNyQytELEVBQWlCdEYsWUFBYyxjQUMvQm9GLEVBQUs1RCxZQUFZOEQsR0FDakIsTUFBTWhGLEVBQWNmLFNBQVM2QixjQUFjLFlBQzNDZCxFQUFZaUIsYUFBYSxLQUFNLGVBQy9CakIsRUFBWWlCLGFBQWEsT0FBUSxlQUNqQ2pCLEVBQVlpQixhQUFhLE9BQVEsS0FDakNqQixFQUFZaUIsYUFBYSxZQUFhLE9BQ3RDNkQsRUFBSzVELFlBQVlsQixHQUdqQixNQUFNaUYsRUFBYWhHLFNBQVM2QixjQUFjLFNBQzFDbUUsRUFBV2hFLGFBQWEsTUFBTyxTQUMvQmdFLEVBQVd2RixZQUFjLFdBQ3pCb0YsRUFBSzVELFlBQVkrRCxHQUNqQixNQUFNQyxFQUFRakcsU0FBUzZCLGNBQWMsU0FDckNvRSxFQUFNakUsYUFBYSxPQUFRLFFBQzNCaUUsRUFBTWpFLGFBQWEsS0FBTSxTQUN6QmlFLEVBQU1qRSxhQUFhLE9BQVEsU0FDM0I2RCxFQUFLNUQsWUFBWWdFLEdBR2pCLE1BQU1wQixFQUFTN0UsU0FBUzZCLGNBQWMsVUFDdENnRCxFQUFPN0MsYUFBYSxLQUFNLGtCQUMxQjZDLEVBQU83QyxhQUFhLE9BQVEsaUJBQzVCNkQsRUFBSzVELFlBQVk0QyxHQUNqQixNQUFNcUIsRUFBZ0JsRyxTQUFTNkIsY0FBYyxVQUM3Q3FFLEVBQWM3RCxNQUFRLFVBQ3RCNkQsRUFBY3pGLFlBQWMsSUFDNUJvRSxFQUFPNUMsWUFBWWlFLEdBR25CLE1BQU1DLEVBQWlCbkcsU0FBUzZCLGNBQWMsVUFDOUNzRSxFQUFlbkUsYUFBYSxLQUFNLG1CQUNsQ21FLEVBQWVuRSxhQUFhLE9BQVEsa0JBQ3BDNkQsRUFBSzVELFlBQVlrRSxHQUNqQixNQUFNQyxFQUFZcEcsU0FBUzZCLGNBQWMsVUFDekN1RSxFQUFVL0QsTUFBUSxJQUNsQitELEVBQVUzRixZQUFjLElBQ3hCMEYsRUFBZWxFLFlBQVltRSxHQUMzQixNQUFNQyxFQUFZckcsU0FBUzZCLGNBQWMsVUFDekN3RSxFQUFVaEUsTUFBUSxJQUNsQmdFLEVBQVU1RixZQUFjLElBQ3hCMEYsRUFBZWxFLFlBQVlvRSxHQUMzQixNQUFNQyxFQUFjdEcsU0FBUzZCLGNBQWMsVUFDM0N5RSxFQUFZakUsTUFBUSxJQUNwQmlFLEVBQVk3RixZQUFjLElBQzFCMEYsRUFBZWxFLFlBQVlxRSxHQUczQixNQUFNQyxFQUFZdkcsU0FBUzZCLGNBQWMsU0FDekMwRSxFQUFVdkUsYUFBYSxPQUFRLFVBQy9CdUUsRUFBVXZFLGFBQWEsS0FBTSxVQUM3QnVFLEVBQVV2RSxhQUFhLFFBQVMsT0FDaEM2RCxFQUFLNUQsWUFBWXNFLEdBRWpCLE1BQU1DLEVBQWV4RyxTQUFTNkIsY0FBYyxVQUM1QzJFLEVBQWF4RSxhQUFhLEtBQU0sVUFDaEN3RSxFQUFhL0YsWUFBYyxTQUMzQm9GLEVBQUs1RCxZQUFZdUUsRUFDbkIsQ0FNRUMsR0d4SGV6RyxTQUFTQyxjQUFjLFdBQy9CNkMsaUJBQWlCLFNBQVVDLElBQ2hDQSxFQUFFRSxpQkFDb0JqRCxTQUFTQyxjQUFjLG1CQUUvQjZCLFVBQVVvQixPQUFPLFVBQy9CLE1BQU0yQyxFQUFPN0YsU0FBU0MsY0FBYyxTQUVwQzRGLEVBQUsvRSxLQUFLdUIsTUFBUSxHQUNsQndELEVBQUs5RSxZQUFZc0IsTUFBUSxHQUN6QndELEVBQUtJLE1BQU01RCxNQUFRLEVBQUUsSUFNWHJDLFNBQVNDLGNBQWMsV0FDL0I2QyxpQkFBaUIsU0FBVUMsSUFDN0JBLEVBQUVFLGlCQUNGLE1BQU00QyxFQUFPN0YsU0FBU0MsY0FBYyxTQUMvQjRGLEVBQUsvRSxLQUFLdUIsT0FBVXdELEVBQUtJLE1BQU01RCxPQUlkckMsU0FBU0MsY0FBYyxtQkFDL0I2QixVQUFVb0IsT0FBTyxVRnlMbkMsU0FBa0IyQyxHQUNoQixNQUFNekUsRUFBUWxCLElBQ1J3RyxFQUFPLENBQ1g1RixLQUFNK0UsRUFBSy9FLEtBQUt1QixNQUNoQnRCLFlBQWE4RSxFQUFLOUUsWUFBWXNCLE1BQzlCckIsS0FBTTZFLEVBQUtJLE1BQU01RCxNQUNqQnBCLFdBQVcsRUFDWEMsUUFBUzJFLEVBQUtjLGNBQWN0RSxNQUM1QmxCLFNBQVUwRSxFQUFLZSxlQUFldkUsT0FFaENqQixFQUFNaUQsS0FBS3FDLEdBQ1hyRyxhQUFhZ0IsUUFBUSxRQUFTbEIsS0FBS21CLFVBQVVGLElBQzdDYixHQUNGLENFck1Jc0csQ0FBU2hCLEdBRVRBLEVBQUtpQixRQUNMdkcsS0FSRXdHLE1BQU0saUNBUUEsSUFNSy9HLFNBQVNDLGNBQWMsZUFDL0I2QyxpQkFBaUIsU0FBUyxLQUNUOUMsU0FBU0MsY0FBYyxtQkFDL0I2QixVQUFVb0IsT0FBTyxTQUFTLElBTXZCbEQsU0FBU0MsY0FBYyxtQkFDL0I2QyxpQkFBaUIsU0FBUyxLQUNuQyxNQUFNa0UsRUFBY0MsT0FBTywrQkFBZ0MsZUFDM0QsSUFBS0QsRUFDSCxPQUVGLE1BQU1FLEVBQWEsQ0FDakJwRCxLQUFNa0QsRUFDTmpELFdBQVcsR0FFYkgsRUFBU3VELFdBQVdELEVBQVcsSUNwRG5DdEQsRUFBU3dELGlCQUNUN0csRyIsInNvdXJjZXMiOlsid2VicGFjazovL3RvZG9saXN0Ly4vc3JjL21vZHVsZXMvdWkuanMiLCJ3ZWJwYWNrOi8vdG9kb2xpc3QvLi9zcmMvbW9kdWxlcy90b2RvLmpzIiwid2VicGFjazovL3RvZG9saXN0Ly4vc3JjL21vZHVsZXMvcHJvamVjdHMuanMiLCJ3ZWJwYWNrOi8vdG9kb2xpc3QvLi9zcmMvbW9kdWxlcy9idXR0b24tZnVuY3Rpb25zLmpzIiwid2VicGFjazovL3RvZG9saXN0Ly4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiYm9keVwiKTtcblxuZnVuY3Rpb24gY3JlYXRlVG9kbygpIHtcbiAgY29uc3QgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgZGl2LmNsYXNzTGlzdC5hZGQoXCJ0b2RvXCIpO1xuICBib2R5LmFwcGVuZENoaWxkKGRpdik7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZVNpZGViYXIoKSB7XG4gIGNvbnN0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIGRpdi5jbGFzc0xpc3QuYWRkKFwic2lkZWJhclwiKTtcbiAgYm9keS5hcHBlbmRDaGlsZChkaXYpO1xuXG4gIGNvbnN0IG5ld0J1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG4gIG5ld0J1dHRvbi5jbGFzc0xpc3QuYWRkKFwibmV3LWJ1dHRvblwiKTtcbiAgbmV3QnV0dG9uLnRleHRDb250ZW50ID0gXCJDcmVhdGUgVGFza1wiO1xuICBkaXYuYXBwZW5kQ2hpbGQobmV3QnV0dG9uKTtcblxuICBjb25zdCBhZGRQcm9qZWN0QnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKTtcbiAgYWRkUHJvamVjdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwicHJvamVjdC1idXR0b25cIik7XG4gIGFkZFByb2plY3RCdXR0b24udGV4dENvbnRlbnQgPSBcIkFkZCBQcm9qZWN0XCI7XG4gIGRpdi5hcHBlbmRDaGlsZChhZGRQcm9qZWN0QnV0dG9uKTtcblxuICBjb25zdCBwcm9qZWN0Q29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgcHJvamVjdENvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwicHJvamVjdC1jb250YWluZXJcIik7XG4gIGRpdi5hcHBlbmRDaGlsZChwcm9qZWN0Q29udGFpbmVyKTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlRm9ybSgpIHtcbiAgLy8gYWRkIGNvbnRhaW5lciBkaXZcbiAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJmb3JtLWNvbnRhaW5lclwiKTtcbiAgY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJoaWRkZW5cIik7XG4gIGJvZHkuYXBwZW5kQ2hpbGQoY29udGFpbmVyKTtcbiAgLy8gYWRkIGNvbnRhaW5lciBkaXZcbiAgY29uc3QgbWFpbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIG1haW4uY2xhc3NMaXN0LmFkZChcImZvcm0tbWFpblwiKTtcbiAgY29udGFpbmVyLmFwcGVuZENoaWxkKG1haW4pO1xuXG4gIC8vIGFkZCBmb3JtXG4gIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZm9ybVwiKTtcbiAgZm9ybS5jbGFzc0xpc3QuYWRkKFwiZm9ybVwiKTtcbiAgbWFpbi5hcHBlbmRDaGlsZChmb3JtKTtcblxuICAvLyBhZGQgdGFzayBuYW1lXG4gIGNvbnN0IHRhc2tMYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsYWJlbFwiKTtcbiAgdGFza0xhYmVsLnNldEF0dHJpYnV0ZShcImZvclwiLCBcInRhc2tcIik7XG4gIHRhc2tMYWJlbC50ZXh0Q29udGVudCA9IFwiVGFzayBUaXRsZVwiO1xuICBmb3JtLmFwcGVuZENoaWxkKHRhc2tMYWJlbCk7XG4gIGNvbnN0IHRhc2sgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIik7XG4gIHRhc2suc2V0QXR0cmlidXRlKFwidHlwZVwiLCBcInRleHRcIik7XG4gIHRhc2suc2V0QXR0cmlidXRlKFwiaWRcIiwgXCJ0YXNrXCIpO1xuICB0YXNrLnNldEF0dHJpYnV0ZShcIm5hbWVcIiwgXCJ0YXNrXCIpO1xuICB0YXNrLnNldEF0dHJpYnV0ZShcInBsYWNlaG9sZGVyXCIsIFwiZS5nLiB3YWxrIHRoZSBkb2dcIik7XG4gIHRhc2suc2V0QXR0cmlidXRlKFwicmVxdWlyZWRcIiwgXCJcIik7XG4gIGZvcm0uYXBwZW5kQ2hpbGQodGFzayk7XG5cbiAgLy8gYWRkIGRlc2NyaXB0aW9uXG4gIGNvbnN0IGRlc2NyaXB0aW9uTGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGFiZWxcIik7XG4gIGRlc2NyaXB0aW9uTGFiZWwuc2V0QXR0cmlidXRlKFwiZm9yXCIsIFwiZGVzY3JpcHRpb25cIik7XG4gIGRlc2NyaXB0aW9uTGFiZWwudGV4dENvbnRlbnQgPSBcIkRlc2NyaXB0aW9uXCI7XG4gIGZvcm0uYXBwZW5kQ2hpbGQoZGVzY3JpcHRpb25MYWJlbCk7XG4gIGNvbnN0IGRlc2NyaXB0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRleHRhcmVhXCIpO1xuICBkZXNjcmlwdGlvbi5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBcImRlc2NyaXB0aW9uXCIpO1xuICBkZXNjcmlwdGlvbi5zZXRBdHRyaWJ1dGUoXCJuYW1lXCIsIFwiZGVzY3JpcHRpb25cIik7XG4gIGRlc2NyaXB0aW9uLnNldEF0dHJpYnV0ZShcInJvd3NcIiwgXCI2XCIpO1xuICBkZXNjcmlwdGlvbi5zZXRBdHRyaWJ1dGUoXCJtYXhsZW5ndGhcIiwgXCIyMDBcIik7XG4gIGZvcm0uYXBwZW5kQ2hpbGQoZGVzY3JpcHRpb24pO1xuXG4gIC8vIGFkZCBkYXRlXG4gIGNvbnN0IGRhdHVtTGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGFiZWxcIik7XG4gIGRhdHVtTGFiZWwuc2V0QXR0cmlidXRlKFwiZm9yXCIsIFwiZGF0dW1cIik7XG4gIGRhdHVtTGFiZWwudGV4dENvbnRlbnQgPSBcIkR1ZSBkYXRlXCI7XG4gIGZvcm0uYXBwZW5kQ2hpbGQoZGF0dW1MYWJlbCk7XG4gIGNvbnN0IGRhdHVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlucHV0XCIpO1xuICBkYXR1bS5zZXRBdHRyaWJ1dGUoXCJ0eXBlXCIsIFwiZGF0ZVwiKTtcbiAgZGF0dW0uc2V0QXR0cmlidXRlKFwiaWRcIiwgXCJkYXR1bVwiKTtcbiAgZGF0dW0uc2V0QXR0cmlidXRlKFwibmFtZVwiLCBcImRhdHVtXCIpO1xuICBmb3JtLmFwcGVuZENoaWxkKGRhdHVtKTtcblxuICAvLyBhZGQgc2VsZWN0XG4gIGNvbnN0IHNlbGVjdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzZWxlY3RcIik7XG4gIHNlbGVjdC5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBcInByb2plY3Qtc2VsZWN0XCIpO1xuICBzZWxlY3Quc2V0QXR0cmlidXRlKFwibmFtZVwiLCBcInByb2plY3RzZWxlY3RcIik7XG4gIGZvcm0uYXBwZW5kQ2hpbGQoc2VsZWN0KTtcbiAgY29uc3Qgb3B0aW9uRGVmYXVsdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJvcHRpb25cIik7XG4gIG9wdGlvbkRlZmF1bHQudmFsdWUgPSBcImRlZmF1bHRcIjtcbiAgb3B0aW9uRGVmYXVsdC50ZXh0Q29udGVudCA9IFwiLVwiO1xuICBzZWxlY3QuYXBwZW5kQ2hpbGQob3B0aW9uRGVmYXVsdCk7XG5cbiAgLy8gYWRkIHByaW9yaXR5XG4gIGNvbnN0IHByaW9yaXR5U2VsZWN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNlbGVjdFwiKTtcbiAgcHJpb3JpdHlTZWxlY3Quc2V0QXR0cmlidXRlKFwiaWRcIiwgXCJwcmlvcml0eS1zZWxlY3RcIik7XG4gIHByaW9yaXR5U2VsZWN0LnNldEF0dHJpYnV0ZShcIm5hbWVcIiwgXCJwcmlvcml0eXNlbGVjdFwiKTtcbiAgZm9ybS5hcHBlbmRDaGlsZChwcmlvcml0eVNlbGVjdCk7XG4gIGNvbnN0IG9wdGlvbk9uZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJvcHRpb25cIik7XG4gIG9wdGlvbk9uZS52YWx1ZSA9IFwiMVwiO1xuICBvcHRpb25PbmUudGV4dENvbnRlbnQgPSBcIjFcIjtcbiAgcHJpb3JpdHlTZWxlY3QuYXBwZW5kQ2hpbGQob3B0aW9uT25lKTtcbiAgY29uc3Qgb3B0aW9uVHdvID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcIm9wdGlvblwiKTtcbiAgb3B0aW9uVHdvLnZhbHVlID0gXCIyXCI7XG4gIG9wdGlvblR3by50ZXh0Q29udGVudCA9IFwiMlwiO1xuICBwcmlvcml0eVNlbGVjdC5hcHBlbmRDaGlsZChvcHRpb25Ud28pO1xuICBjb25zdCBvcHRpb25UaHJlZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJvcHRpb25cIik7XG4gIG9wdGlvblRocmVlLnZhbHVlID0gXCIzXCI7XG4gIG9wdGlvblRocmVlLnRleHRDb250ZW50ID0gXCIzXCI7XG4gIHByaW9yaXR5U2VsZWN0LmFwcGVuZENoaWxkKG9wdGlvblRocmVlKTtcblxuICAvLyBhZGQgYnV0dG9uXG4gIGNvbnN0IGFkZEJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTtcbiAgYWRkQnV0dG9uLnNldEF0dHJpYnV0ZShcInR5cGVcIiwgXCJzdWJtaXRcIik7XG4gIGFkZEJ1dHRvbi5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBcInN1Ym1pdFwiKTtcbiAgYWRkQnV0dG9uLnNldEF0dHJpYnV0ZShcInZhbHVlXCIsIFwiQWRkXCIpO1xuICBmb3JtLmFwcGVuZENoaWxkKGFkZEJ1dHRvbik7XG4gIC8vIGNhbmNlbCBidXR0b25cbiAgY29uc3QgY2FuY2VsQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKTtcbiAgY2FuY2VsQnV0dG9uLnNldEF0dHJpYnV0ZShcImlkXCIsIFwiY2FuY2VsXCIpO1xuICBjYW5jZWxCdXR0b24udGV4dENvbnRlbnQgPSBcIkNhbmNlbFwiO1xuICBmb3JtLmFwcGVuZENoaWxkKGNhbmNlbEJ1dHRvbik7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGNyZWF0ZVN0cnVjdHVyZSgpIHtcbiAgY3JlYXRlU2lkZWJhcigpO1xuICAvLyBjcmVhdGVIZWFkZXIoKTtcbiAgY3JlYXRlVG9kbygpO1xuICBjcmVhdGVGb3JtKCk7XG59XG4iLCIvLyBnZXQgaXRlbXMgZnJvbSBsb2NhbCBzdG9yYWdlXG5mdW5jdGlvbiBwYXJzZUxvY2FsU3RvcmFnZSgpIHtcbiAgcmV0dXJuIEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJ0b0Rvc1wiKSkgfHwgW107XG59XG4vLyByZW5kZXIgdGFza3MgZnJvbSBsb2NhbCBzdG9yYWdlXG5mdW5jdGlvbiByZW5kZXIobGlzdCkge1xuICBjb25zdCBpbmJveCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudG9kb1wiKTtcbiAgaW5ib3gudGV4dENvbnRlbnQgPSBcIlwiO1xuXG4gIGlmIChsaXN0KSB7XG4gICAgY29uc3QgdG9Eb3MgPSBsaXN0O1xuICAgIHRvRG9zLmZvckVhY2goKGl0ZW0sIGlkKSA9PiB7XG4gICAgICAoKCkgPT5cbiAgICAgICAgbmV3IFRhc2soXG4gICAgICAgICAgaXRlbS5pZCxcbiAgICAgICAgICBpZCxcbiAgICAgICAgICBpdGVtLnRhc2ssXG4gICAgICAgICAgaXRlbS5kZXNjcmlwdGlvbixcbiAgICAgICAgICBpdGVtLmRhdGUsXG4gICAgICAgICAgaXRlbS5jb21wbGV0ZWQsXG4gICAgICAgICAgaXRlbS5wcm9qZWN0LFxuICAgICAgICAgIGl0ZW0ucHJpb3JpdHlcbiAgICAgICAgKSkoKTtcbiAgICB9KTtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zdCB0b0RvcyA9IHBhcnNlTG9jYWxTdG9yYWdlKCk7XG4gIHRvRG9zLmZvckVhY2goKGl0ZW0sIGlkKSA9PiB7XG4gICAgKCgpID0+XG4gICAgICBuZXcgVGFzayhcbiAgICAgICAgaWQsXG4gICAgICAgIGlkLFxuICAgICAgICBpdGVtLnRhc2ssXG4gICAgICAgIGl0ZW0uZGVzY3JpcHRpb24sXG4gICAgICAgIGl0ZW0uZGF0ZSxcbiAgICAgICAgaXRlbS5jb21wbGV0ZWQsXG4gICAgICAgIGl0ZW0ucHJvamVjdCxcbiAgICAgICAgaXRlbS5wcmlvcml0eVxuICAgICAgKSkoKTtcbiAgICB0b0Rvc1tpZF0uaWQgPSBpZDtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcInRvRG9zXCIsIEpTT04uc3RyaW5naWZ5KHRvRG9zKSk7XG4gIH0pO1xufVxuLy8gY3JlYXRlIHRhc2tzXG5jbGFzcyBUYXNrIHtcbiAgY29uc3RydWN0b3IoXG4gICAgaWQsXG4gICAgbGlzdElkLFxuICAgIHRpdGxlLFxuICAgIGRlc2NyaXB0aW9uLFxuICAgIGRhdGUsXG4gICAgY29tcGxldGVkLFxuICAgIHByb2plY3QsXG4gICAgcHJpb3JpdHlcbiAgKSB7XG4gICAgdGhpcy5pZCA9IGlkO1xuICAgIHRoaXMubGlzdElkID0gbGlzdElkO1xuICAgIHRoaXMudGl0bGUgPSB0aXRsZTtcbiAgICB0aGlzLmRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb247XG4gICAgdGhpcy5kYXRlID0gZGF0ZTtcbiAgICB0aGlzLmNvbXBsZXRlZCA9IGNvbXBsZXRlZDtcbiAgICB0aGlzLnByb2plY3QgPSBwcm9qZWN0O1xuICAgIHRoaXMucHJpb3JpdHkgPSBwcmlvcml0eTtcbiAgICB0aGlzLiNjcmVhdGUoKTtcbiAgfVxuXG4gIGNyZWF0ZVRhc2tDb250YWluZXIoaW5ib3gpIHtcbiAgICAvLyB0YXNrIGNvbnRhaW5lclxuICAgIGNvbnN0IHRhc2sgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIHRhc2suY2xhc3NMaXN0LmFkZChcInRhc2stY29udGFpbmVyXCIpO1xuICAgIHRhc2suc2V0QXR0cmlidXRlKFwiaWRcIiwgdGhpcy5pZCk7XG4gICAgaW5ib3guYXBwZW5kQ2hpbGQodGFzayk7XG4gICAgc3dpdGNoICh0aGlzLnByaW9yaXR5KSB7XG4gICAgICBjYXNlIFwiMVwiOlxuICAgICAgICB0YXNrLmNsYXNzTGlzdC5hZGQoXCJwcmlvMVwiKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFwiMlwiOlxuICAgICAgICB0YXNrLmNsYXNzTGlzdC5hZGQoXCJwcmlvMlwiKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFwiM1wiOlxuICAgICAgICB0YXNrLmNsYXNzTGlzdC5hZGQoXCJwcmlvM1wiKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICBjb25zb2xlLmxvZyhcImJsYWNrXCIpO1xuICAgICAgICBicmVhaztcbiAgICB9XG4gICAgcmV0dXJuIHRhc2s7XG4gIH1cblxuICAvLyBjcmVhdGUgdGFzayB1aSBhbmQgZnVuY3Rpb25zXG4gICNjcmVhdGUoKSB7XG4gICAgY29uc3QgaW5ib3ggPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRvZG9cIik7XG4gICAgLy8gdGFzayBjb250YWluZXJcbiAgICBjb25zdCB0YXNrID0gdGhpcy5jcmVhdGVUYXNrQ29udGFpbmVyKGluYm94KTtcblxuICAgIC8vIHRhc2sgZm9ybVxuICAgIGNvbnN0IHRhc2tGb3JtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImZvcm1cIik7XG4gICAgdGFza0Zvcm0uY2xhc3NMaXN0LmFkZChcInRhc2stZm9ybVwiKTtcbiAgICB0YXNrLmFwcGVuZENoaWxkKHRhc2tGb3JtKTtcblxuICAgIC8vIHRhc2sgdGl0bGVcbiAgICBjb25zdCB0aXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTtcbiAgICB0aXRsZS5zZXRBdHRyaWJ1dGUoXCJ0eXBlXCIsIFwidGV4dFwiKTtcbiAgICB0aXRsZS5zZXRBdHRyaWJ1dGUoXCJuYW1lXCIsIFwidGFza1RpdGxlXCIpO1xuICAgIHRpdGxlLnZhbHVlID0gdGhpcy50aXRsZTtcbiAgICB0aXRsZS5jbGFzc0xpc3QuYWRkKFwidGFzay10aXRsZVwiKTtcbiAgICB0aXRsZS5yZWFkT25seSA9IHRydWU7XG4gICAgdGFza0Zvcm0uYXBwZW5kQ2hpbGQodGl0bGUpO1xuXG4gICAgLy8gdGFzayBkZXNjcmlwdGlvblxuICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRleHRhcmVhXCIpO1xuICAgIGRlc2NyaXB0aW9uLnNldEF0dHJpYnV0ZShcIm5hbWVcIiwgXCJ0YXNrRGVzY3JpcHRpb25cIik7XG4gICAgZGVzY3JpcHRpb24uc2V0QXR0cmlidXRlKFwicm93c1wiLCAxKTtcbiAgICBkZXNjcmlwdGlvbi52YWx1ZSA9IHRoaXMuZGVzY3JpcHRpb247XG4gICAgZGVzY3JpcHRpb24uY2xhc3NMaXN0LmFkZChcInRhc2stZGVzY3JpcHRpb25cIik7XG4gICAgZGVzY3JpcHRpb24ucmVhZE9ubHkgPSB0cnVlO1xuICAgIHRhc2tGb3JtLmFwcGVuZENoaWxkKGRlc2NyaXB0aW9uKTtcblxuICAgIC8vIHRhc2sgZGF0ZVxuICAgIGNvbnN0IGRhdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIik7XG4gICAgZGF0ZS5zZXRBdHRyaWJ1dGUoXCJ0eXBlXCIsIFwiZGF0ZVwiKTtcbiAgICBkYXRlLnNldEF0dHJpYnV0ZShcIm5hbWVcIiwgXCJ0YXNrRGF0ZVwiKTtcbiAgICBkYXRlLnZhbHVlID0gdGhpcy5kYXRlO1xuICAgIGRhdGUuY2xhc3NMaXN0LmFkZChcInRhc2stZGF0ZVwiKTtcbiAgICBkYXRlLnJlYWRPbmx5ID0gdHJ1ZTtcbiAgICB0YXNrRm9ybS5hcHBlbmRDaGlsZChkYXRlKTtcblxuICAgIC8vIHByb2plY3Qgc2VsZWN0b3JcbiAgICBjb25zdCBwcm9qZWN0U2VsZWN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNlbGVjdFwiKTtcbiAgICBwcm9qZWN0U2VsZWN0LmNsYXNzTGlzdC5hZGQoXCJ0YXNrLXNlbGVjdG9yXCIpO1xuICAgIHByb2plY3RTZWxlY3QuZGlzYWJsZWQgPSB0cnVlO1xuICAgIHRhc2tGb3JtLmFwcGVuZENoaWxkKHByb2plY3RTZWxlY3QpO1xuICAgIGNvbnN0IGFsbE9wdGlvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiI3Byb2plY3Qtc2VsZWN0IG9wdGlvblwiKTtcbiAgICBhbGxPcHRpb25zLmZvckVhY2goKG9wdCkgPT4ge1xuICAgICAgY29uc3QgbmV3T3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcIm9wdGlvblwiKTtcbiAgICAgIG5ld09wdGlvbi52YWx1ZSA9IG9wdC52YWx1ZTtcbiAgICAgIG5ld09wdGlvbi50ZXh0Q29udGVudCA9IG9wdC5sYWJlbDtcbiAgICAgIGlmICh0aGlzLnByb2plY3QgPT09IG9wdC52YWx1ZSkge1xuICAgICAgICBuZXdPcHRpb24uc2V0QXR0cmlidXRlKFwic2VsZWN0ZWRcIiwgXCJzZWxlY3RlZFwiKTtcbiAgICAgIH1cbiAgICAgIHByb2plY3RTZWxlY3QuYXBwZW5kQ2hpbGQobmV3T3B0aW9uKTtcbiAgICB9KTtcblxuICAgIGZ1bmN0aW9uIGRpc2FibGVCdXR0b25zKGl0ZW1JZCkge1xuICAgICAgY29uc3Qgc2VsZWN0Rm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIudGFzay1mb3JtXCIpO1xuICAgICAgc2VsZWN0Rm9ybS5mb3JFYWNoKChpdGVtLCBpZCkgPT4ge1xuICAgICAgICBpZiAoaXRlbUlkICE9PSBpZCkge1xuICAgICAgICAgIGNvbnN0IHNlbGVjdEVkaXQgPSBpdGVtLnF1ZXJ5U2VsZWN0b3IoXCIuZWRpdC1idXR0b25cIik7XG4gICAgICAgICAgc2VsZWN0RWRpdC5kaXNhYmxlZCA9IHRydWU7XG4gICAgICAgICAgY29uc3Qgc2VsZWN0RGVsZXRlID0gaXRlbS5xdWVyeVNlbGVjdG9yKFwiLmRlbGV0ZS1idXR0b25cIik7XG4gICAgICAgICAgc2VsZWN0RGVsZXRlLmRpc2FibGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gdGFzayBlZGl0IGJ1dHRvbiBhbmQgZnVuY3Rpb25zXG4gICAgY29uc3QgZWRpdEJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTtcbiAgICBlZGl0QnRuLnNldEF0dHJpYnV0ZShcInR5cGVcIiwgXCJzdWJtaXRcIik7XG4gICAgZWRpdEJ0bi52YWx1ZSA9IFwiRURJVFwiO1xuICAgIGVkaXRCdG4uY2xhc3NMaXN0LmFkZChcImVkaXQtYnV0dG9uXCIpO1xuICAgIGVkaXRCdG4uY2xhc3NMaXN0LmFkZChcInRhc2stYnV0dG9uXCIpO1xuICAgIHRhc2tGb3JtLmFwcGVuZENoaWxkKGVkaXRCdG4pO1xuXG4gICAgZWRpdEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIGRpc2FibGVCdXR0b25zKHRoaXMubGlzdElkKTtcbiAgICAgIGVkaXRCdG4udmFsdWUgPSBcIlNBVkVcIjtcbiAgICAgIHRpdGxlLnJlYWRPbmx5ID0gZmFsc2U7XG4gICAgICB0aXRsZS5jbGFzc0xpc3QudG9nZ2xlKFwiZWRpdFwiKTtcbiAgICAgIGRlc2NyaXB0aW9uLnJlYWRPbmx5ID0gZmFsc2U7XG4gICAgICBkZXNjcmlwdGlvbi5jbGFzc0xpc3QudG9nZ2xlKFwiZWRpdFwiKTtcbiAgICAgIGRhdGUucmVhZE9ubHkgPSBmYWxzZTtcbiAgICAgIGRhdGUuY2xhc3NMaXN0LnRvZ2dsZShcImVkaXRcIik7XG4gICAgICBwcm9qZWN0U2VsZWN0LmRpc2FibGVkID0gZmFsc2U7XG5cbiAgICAgIGVkaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldmVudCkgPT4ge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBlZGl0QnRuLnZhbHVlID0gXCJFRElUXCI7XG4gICAgICAgIHRpdGxlLnJlYWRPbmx5ID0gdHJ1ZTtcbiAgICAgICAgdGl0bGUuY2xhc3NMaXN0LnRvZ2dsZShcImVkaXRcIik7XG4gICAgICAgIGRlc2NyaXB0aW9uLnJlYWRPbmx5ID0gdHJ1ZTtcbiAgICAgICAgZGVzY3JpcHRpb24uY2xhc3NMaXN0LnRvZ2dsZShcImVkaXRcIik7XG4gICAgICAgIGRhdGUucmVhZE9ubHkgPSB0cnVlO1xuICAgICAgICBwcm9qZWN0U2VsZWN0LmRpc2FibGVkID0gdHJ1ZTtcblxuICAgICAgICBkYXRlLmNsYXNzTGlzdC50b2dnbGUoXCJlZGl0XCIpO1xuICAgICAgICBjb25zdCBkYXRhID0gcGFyc2VMb2NhbFN0b3JhZ2UoKTtcbiAgICAgICAgZGF0YVt0aGlzLmlkXS50YXNrID0gdGFza0Zvcm0udGFza1RpdGxlLnZhbHVlO1xuICAgICAgICBkYXRhW3RoaXMuaWRdLmRlc2NyaXB0aW9uID0gdGFza0Zvcm0udGFza0Rlc2NyaXB0aW9uLnZhbHVlO1xuICAgICAgICBkYXRhW3RoaXMuaWRdLmRhdGUgPSB0YXNrRm9ybS50YXNrRGF0ZS52YWx1ZTtcbiAgICAgICAgZGF0YVt0aGlzLmlkXS5wcm9qZWN0ID0gcHJvamVjdFNlbGVjdC52YWx1ZTtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJ0b0Rvc1wiLCBKU09OLnN0cmluZ2lmeShkYXRhKSk7XG4gICAgICAgIHJlbmRlcigpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvLyB0YXNrIGRlbGV0ZSBidXR0b24gYW5kIGZ1bmN0aW9uc1xuICAgIGNvbnN0IGRlbGV0ZUJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG4gICAgZGVsZXRlQnRuLnRleHRDb250ZW50ID0gXCJET05FXCI7XG4gICAgZGVsZXRlQnRuLmNsYXNzTGlzdC5hZGQoXCJkZWxldGUtYnV0dG9uXCIpO1xuICAgIGRlbGV0ZUJ0bi5jbGFzc0xpc3QuYWRkKFwidGFzay1idXR0b25cIik7XG4gICAgdGFza0Zvcm0uYXBwZW5kQ2hpbGQoZGVsZXRlQnRuKTtcblxuICAgIGRlbGV0ZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGRlbCkgPT4ge1xuICAgICAgZGVsLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBjb25zdCBkYXRhID0gcGFyc2VMb2NhbFN0b3JhZ2UoKTtcbiAgICAgIGRhdGEuc3BsaWNlKHRoaXMuaWQsIDEpO1xuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi50YXNrLWNvbnRhaW5lclwiKVt0aGlzLmxpc3RJZF0ucmVtb3ZlKCk7XG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcInRvRG9zXCIsIEpTT04uc3RyaW5naWZ5KGRhdGEpKTtcbiAgICAgIC8vIHJlbmRlcigpO1xuICAgIH0pO1xuICB9XG59XG4vLyBzYXZlIG5ldyB0YXNrIHRvIHRoZSBsb2NhTCBzdG9yYWdlXG5mdW5jdGlvbiBzYXZlVG9Ebyhmb3JtKSB7XG4gIGNvbnN0IHRvRG9zID0gcGFyc2VMb2NhbFN0b3JhZ2UoKTtcbiAgY29uc3QgdG9EbyA9IHtcbiAgICB0YXNrOiBmb3JtLnRhc2sudmFsdWUsXG4gICAgZGVzY3JpcHRpb246IGZvcm0uZGVzY3JpcHRpb24udmFsdWUsXG4gICAgZGF0ZTogZm9ybS5kYXR1bS52YWx1ZSxcbiAgICBjb21wbGV0ZWQ6IGZhbHNlLFxuICAgIHByb2plY3Q6IGZvcm0ucHJvamVjdHNlbGVjdC52YWx1ZSxcbiAgICBwcmlvcml0eTogZm9ybS5wcmlvcml0eXNlbGVjdC52YWx1ZSxcbiAgfTtcbiAgdG9Eb3MucHVzaCh0b0RvKTtcbiAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJ0b0Rvc1wiLCBKU09OLnN0cmluZ2lmeSh0b0RvcykpO1xuICByZW5kZXIoKTtcbn1cblxuZXhwb3J0IHsgc2F2ZVRvRG8sIFRhc2ssIHJlbmRlciwgcGFyc2VMb2NhbFN0b3JhZ2UgfTtcbiIsImltcG9ydCB7IHBhcnNlTG9jYWxTdG9yYWdlLCByZW5kZXIgfSBmcm9tIFwiLi90b2RvXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFByb2plY3RzIHtcbiAgc3RhdGljIHByb2plY3RzID0gW1xuICAgIHtcbiAgICAgIG5hbWU6IFwiSW5ib3hcIixcbiAgICAgIHByb3RlY3RlZDogdHJ1ZSxcbiAgICB9LFxuICAgIHtcbiAgICAgIG5hbWU6IFwiVG9kYXlcIixcbiAgICAgIHByb3RlY3RlZDogdHJ1ZSxcbiAgICB9LFxuICBdO1xuXG4gIHN0YXRpYyByZW5kZXJQcm9qZWN0cygpIHtcbiAgICBjb25zdCBpdGVtcyA9IHRoaXMucGFyc2VQcm9qZWN0cygpO1xuICAgIGl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgIHRoaXMuY3JlYXRlUHJvamVjdChpdGVtKTtcbiAgICB9KTtcbiAgICAvLyB0aGlzLm5ld1Byb2plY3QoeyBuYW1lOiBcIkR1bW15XCIsIHByb3RlY3RlZDogZmFsc2UgfSk7XG4gIH1cblxuICBzdGF0aWMgcGFyc2VQcm9qZWN0cygpIHtcbiAgICBsZXQgaXRlbXMgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwicHJvamVjdExpc3RcIikpIHx8IFtdO1xuICAgIGlmIChpdGVtcy5sZW5ndGggPT09IDApIHtcbiAgICAgIGl0ZW1zID0gdGhpcy5wcm9qZWN0cztcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwicHJvamVjdExpc3RcIiwgSlNPTi5zdHJpbmdpZnkoaXRlbXMpKTtcbiAgICB9XG4gICAgcmV0dXJuIGl0ZW1zO1xuICB9XG5cbiAgc3RhdGljIGFkZFByb2plY3RzKGl0ZW0pIHtcbiAgICBjb25zdCBpdGVtcyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJwcm9qZWN0TGlzdFwiKSk7XG4gICAgaXRlbXMucHVzaChpdGVtKTtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcInByb2plY3RMaXN0XCIsIEpTT04uc3RyaW5naWZ5KGl0ZW1zKSk7XG4gIH1cblxuICBzdGF0aWMgcmVtb3ZlUHJvamVjdHMoaW5kZXgpIHtcbiAgICBjb25zdCBpdGVtcyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJwcm9qZWN0TGlzdFwiKSk7XG4gICAgaXRlbXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcInByb2plY3RMaXN0XCIsIEpTT04uc3RyaW5naWZ5KGl0ZW1zKSk7XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5wcm9qZWN0XCIpW2luZGV4XS5yZW1vdmUoKTtcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiI3Byb2plY3Qtc2VsZWN0IG9wdGlvblwiKVtpbmRleCAtIDFdLnJlbW92ZSgpO1xuICAgIHJlbmRlcigpO1xuICB9XG5cbiAgc3RhdGljIGNyZWF0ZVByb2plY3QoaXRlbSkge1xuICAgIGNvbnN0IHByb2plY3RDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2plY3QtY29udGFpbmVyXCIpO1xuICAgIGNvbnN0IHByb2plY3RJdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICBwcm9qZWN0SXRlbS5jbGFzc0xpc3QuYWRkKFwicHJvamVjdFwiKTtcbiAgICBwcm9qZWN0SXRlbS5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBpdGVtLm5hbWUpO1xuICAgIHByb2plY3RDb250YWluZXIuYXBwZW5kQ2hpbGQocHJvamVjdEl0ZW0pO1xuICAgIGNvbnN0IHByb2plY3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicFwiKTtcbiAgICBwcm9qZWN0LnRleHRDb250ZW50ID0gaXRlbS5uYW1lO1xuICAgIHByb2plY3RJdGVtLmFwcGVuZENoaWxkKHByb2plY3QpO1xuXG4gICAgaWYgKCFpdGVtLnByb3RlY3RlZCkge1xuICAgICAgY29uc3QgcHJvamVjdERlbGV0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG4gICAgICBwcm9qZWN0RGVsZXRlLnRleHRDb250ZW50ID0gXCJERUxcIjtcbiAgICAgIHByb2plY3RJdGVtLmFwcGVuZENoaWxkKHByb2plY3REZWxldGUpO1xuICAgICAgcHJvamVjdERlbGV0ZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICBjb25zdCBwcm9qZWN0cyA9IHRoaXMucGFyc2VQcm9qZWN0cygpO1xuICAgICAgICBjb25zdCBpbmRleCA9IHByb2plY3RzLmZpbmRJbmRleChcbiAgICAgICAgICAoc2VhcmNoRm9yKSA9PiBzZWFyY2hGb3IubmFtZSA9PT0gaXRlbS5uYW1lXG4gICAgICAgICk7XG4gICAgICAgIHRoaXMucmVtb3ZlUHJvamVjdHMoaW5kZXgpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKFxuICAgICAgaXRlbS5uYW1lICE9PSBcIkluYm94XCIgJiZcbiAgICAgIGl0ZW0ubmFtZSAhPT0gXCJUb2RheVwiICYmXG4gICAgICBpdGVtLm5hbWUgIT09IFwiTGF0ZVwiXG4gICAgKSB7XG4gICAgICBjb25zdCBzZWxlY3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2plY3Qtc2VsZWN0XCIpO1xuICAgICAgY29uc3QgbmV3T3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcIm9wdGlvblwiKTtcbiAgICAgIG5ld09wdGlvbi52YWx1ZSA9IGl0ZW0ubmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgbmV3T3B0aW9uLnRleHRDb250ZW50ID0gaXRlbS5uYW1lO1xuICAgICAgc2VsZWN0LmFwcGVuZENoaWxkKG5ld09wdGlvbik7XG4gICAgfVxuXG4gICAgcHJvamVjdC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgY29uc3QgbG9jYWxMaXN0ID0gcGFyc2VMb2NhbFN0b3JhZ2UoKTtcbiAgICAgIGlmIChpdGVtLm5hbWUgPT09IFwiSW5ib3hcIikge1xuICAgICAgICByZW5kZXIoKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAoaXRlbS5uYW1lID09PSBcIlRvZGF5XCIpIHtcbiAgICAgICAgY29uc3QgZmlsdGVyZWRMaXN0ID0gbG9jYWxMaXN0LmZpbHRlcigobG9jYWxJdGVtKSA9PiB7XG4gICAgICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKCkudG9KU09OKCk7XG4gICAgICAgICAgY29uc3QgY3VycmVudERhdGUgPSBEYXRlLnBhcnNlKGRhdGUpO1xuICAgICAgICAgIGNvbnN0IGxvY2FsSXRlbURhdGUgPSBEYXRlLnBhcnNlKGxvY2FsSXRlbS5kYXRlKTtcbiAgICAgICAgICByZXR1cm4gbG9jYWxJdGVtRGF0ZSA8IGN1cnJlbnREYXRlO1xuICAgICAgICB9KTtcbiAgICAgICAgcmVuZGVyKGZpbHRlcmVkTGlzdCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgY29uc3QgZmlsdGVyZWRMaXN0ID0gbG9jYWxMaXN0LmZpbHRlcihcbiAgICAgICAgKGxvY2FsSXRlbSkgPT4gbG9jYWxJdGVtLnByb2plY3QgPT09IGl0ZW0ubmFtZS50b0xvd2VyQ2FzZSgpXG4gICAgICApO1xuICAgICAgcmVuZGVyKGZpbHRlcmVkTGlzdCk7XG4gICAgfSk7XG4gIH1cblxuICBzdGF0aWMgbmV3UHJvamVjdChpdGVtKSB7XG4gICAgdGhpcy5jcmVhdGVQcm9qZWN0KGl0ZW0pO1xuICAgIHRoaXMuYWRkUHJvamVjdHMoaXRlbSk7XG4gICAgcmVuZGVyKCk7XG4gIH1cbn1cbiIsImltcG9ydCB7IHNhdmVUb0RvLCByZW5kZXIgfSBmcm9tIFwiLi90b2RvXCI7XG5pbXBvcnQgUHJvamVjdHMgZnJvbSBcIi4vcHJvamVjdHNcIjtcblxuLy8gZnVuY3Rpb24gZm9yIGNhbmNlbCBidXR0b25cbmZ1bmN0aW9uIGNhbmNlbEJ1dHRvbigpIHtcbiAgY29uc3QgY2FuY2VsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYW5jZWxcIik7XG4gIGNhbmNlbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgY29uc3QgZm9ybUNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybS1jb250YWluZXJcIik7XG4gICAgLy8gY29uc29sZS5sb2coXCJkb25lXCIpO1xuICAgIGZvcm1Db250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZShcImhpZGRlblwiKTtcbiAgICBjb25zdCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5mb3JtXCIpO1xuICAgIC8vIHNldCB2YWx1ZXMgdG8gZGVmYXVsdFxuICAgIGZvcm0udGFzay52YWx1ZSA9IFwiXCI7XG4gICAgZm9ybS5kZXNjcmlwdGlvbi52YWx1ZSA9IFwiXCI7XG4gICAgZm9ybS5kYXR1bS52YWx1ZSA9IFwiXCI7XG4gIH0pO1xufVxuXG4vLyBmdW5jdGlvbiBmb3IgYWRkIGJ1dHRvblxuZnVuY3Rpb24gYWRkQnV0dG9uKCkge1xuICBjb25zdCBhZGQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3N1Ym1pdFwiKTtcbiAgYWRkLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBjb25zdCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5mb3JtXCIpO1xuICAgIGlmICghZm9ybS50YXNrLnZhbHVlIHx8ICFmb3JtLmRhdHVtLnZhbHVlKSB7XG4gICAgICBhbGVydChcIlBsZWFzZSBhZGQgVGl0bGUgYW5kIER1ZSBkYXRlIVwiKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgZm9ybUNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybS1jb250YWluZXJcIik7XG4gICAgZm9ybUNvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKFwiaGlkZGVuXCIpO1xuICAgIHNhdmVUb0RvKGZvcm0pO1xuICAgIC8vIHNldCB2YWx1ZXMgdG8gZGVmYXVsdFxuICAgIGZvcm0ucmVzZXQoKTtcbiAgICByZW5kZXIoKTtcbiAgfSk7XG59XG5cbi8vIGZ1bmN0aW9uIGZvciBuZXcgYnV0dG9uXG5mdW5jdGlvbiBuZXdCdXR0b24oKSB7XG4gIGNvbnN0IG5ld0J0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubmV3LWJ1dHRvblwiKTtcbiAgbmV3QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgY29uc3QgZm9ybUNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybS1jb250YWluZXJcIik7XG4gICAgZm9ybUNvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKFwiaGlkZGVuXCIpO1xuICB9KTtcbn1cblxuLy8gZnVuY3Rpb24gZm9yIHByb2plY3QgYnV0dG9uXG5mdW5jdGlvbiBhZGRQcm9qZWN0KCkge1xuICBjb25zdCBwcm9qZWN0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9qZWN0LWJ1dHRvblwiKTtcbiAgcHJvamVjdEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIGNvbnN0IHByb2plY3ROYW1lID0gcHJvbXB0KFwiUGxlYXNlIGVudGVyIGEgcHJvamVjdCBuYW1lOlwiLCBcIk5ldyBQcm9qZWN0XCIpO1xuICAgIGlmICghcHJvamVjdE5hbWUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgcHJvamVjdE9iaiA9IHtcbiAgICAgIG5hbWU6IHByb2plY3ROYW1lLFxuICAgICAgcHJvdGVjdGVkOiBmYWxzZSxcbiAgICB9O1xuICAgIFByb2plY3RzLm5ld1Byb2plY3QocHJvamVjdE9iaik7XG4gIH0pO1xufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBidXR0b25GdW5jdGlvbnMoKSB7XG4gIGNhbmNlbEJ1dHRvbigpO1xuICBhZGRCdXR0b24oKTtcbiAgbmV3QnV0dG9uKCk7XG4gIGFkZFByb2plY3QoKTtcbn1cbiIsImltcG9ydCBjcmVhdGVTdHJ1Y3R1cmUgZnJvbSBcIi4vbW9kdWxlcy91aVwiO1xuaW1wb3J0IGJ1dHRvbkZ1bmN0aW9ucyBmcm9tIFwiLi9tb2R1bGVzL2J1dHRvbi1mdW5jdGlvbnNcIjtcbmltcG9ydCB7IHJlbmRlciB9IGZyb20gXCIuL21vZHVsZXMvdG9kb1wiO1xuaW1wb3J0IFByb2plY3RzIGZyb20gXCIuL21vZHVsZXMvcHJvamVjdHNcIjtcblxuY3JlYXRlU3RydWN0dXJlKCk7XG5idXR0b25GdW5jdGlvbnMoKTtcblByb2plY3RzLnJlbmRlclByb2plY3RzKCk7XG5yZW5kZXIoKTtcbiJdLCJuYW1lcyI6WyJib2R5IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwicGFyc2VMb2NhbFN0b3JhZ2UiLCJKU09OIiwicGFyc2UiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwicmVuZGVyIiwibGlzdCIsInRleHRDb250ZW50IiwiZm9yRWFjaCIsIml0ZW0iLCJpZCIsIlRhc2siLCJ0YXNrIiwiZGVzY3JpcHRpb24iLCJkYXRlIiwiY29tcGxldGVkIiwicHJvamVjdCIsInByaW9yaXR5IiwidG9Eb3MiLCJzZXRJdGVtIiwic3RyaW5naWZ5IiwiY29uc3RydWN0b3IiLCJsaXN0SWQiLCJ0aXRsZSIsInRoaXMiLCJjcmVhdGVUYXNrQ29udGFpbmVyIiwiaW5ib3giLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwic2V0QXR0cmlidXRlIiwiYXBwZW5kQ2hpbGQiLCJjb25zb2xlIiwibG9nIiwidGFza0Zvcm0iLCJ2YWx1ZSIsInJlYWRPbmx5IiwicHJvamVjdFNlbGVjdCIsImRpc2FibGVkIiwicXVlcnlTZWxlY3RvckFsbCIsIm9wdCIsIm5ld09wdGlvbiIsImxhYmVsIiwiZWRpdEJ0biIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwiaXRlbUlkIiwicHJldmVudERlZmF1bHQiLCJ0b2dnbGUiLCJldmVudCIsImRhdGEiLCJ0YXNrVGl0bGUiLCJ0YXNrRGVzY3JpcHRpb24iLCJ0YXNrRGF0ZSIsImRlbGV0ZUJ0biIsImRlbCIsInNwbGljZSIsInJlbW92ZSIsIlByb2plY3RzIiwic3RhdGljIiwibmFtZSIsInByb3RlY3RlZCIsInBhcnNlUHJvamVjdHMiLCJjcmVhdGVQcm9qZWN0IiwiaXRlbXMiLCJsZW5ndGgiLCJwcm9qZWN0cyIsInB1c2giLCJpbmRleCIsInByb2plY3RDb250YWluZXIiLCJwcm9qZWN0SXRlbSIsInByb2plY3REZWxldGUiLCJmaW5kSW5kZXgiLCJzZWFyY2hGb3IiLCJyZW1vdmVQcm9qZWN0cyIsInNlbGVjdCIsInRvTG93ZXJDYXNlIiwibG9jYWxMaXN0IiwiZmlsdGVyIiwibG9jYWxJdGVtIiwiRGF0ZSIsInRvSlNPTiIsImN1cnJlbnREYXRlIiwiYWRkUHJvamVjdHMiLCJkaXYiLCJuZXdCdXR0b24iLCJhZGRQcm9qZWN0QnV0dG9uIiwiY3JlYXRlU2lkZWJhciIsImNyZWF0ZVRvZG8iLCJjb250YWluZXIiLCJtYWluIiwiZm9ybSIsInRhc2tMYWJlbCIsImRlc2NyaXB0aW9uTGFiZWwiLCJkYXR1bUxhYmVsIiwiZGF0dW0iLCJvcHRpb25EZWZhdWx0IiwicHJpb3JpdHlTZWxlY3QiLCJvcHRpb25PbmUiLCJvcHRpb25Ud28iLCJvcHRpb25UaHJlZSIsImFkZEJ1dHRvbiIsImNhbmNlbEJ1dHRvbiIsImNyZWF0ZUZvcm0iLCJ0b0RvIiwicHJvamVjdHNlbGVjdCIsInByaW9yaXR5c2VsZWN0Iiwic2F2ZVRvRG8iLCJyZXNldCIsImFsZXJ0IiwicHJvamVjdE5hbWUiLCJwcm9tcHQiLCJwcm9qZWN0T2JqIiwibmV3UHJvamVjdCIsInJlbmRlclByb2plY3RzIl0sInNvdXJjZVJvb3QiOiIifQ==